# 요구사항 명세서

## 1. 개요

### 1. 목적

VeilGram은 사용자 개인정보를 최소로 하는 익명 SNS 서비스로 사용자 간의 자유로운 소통과 정보 공유를 지원합니다. 본 문서는 서비스의 기능 및 비기능 요구사항을 정의하여 개발 및 운영에 필요한 가이드라인을 제공합니다.

### 2. 배경

최근 SNS 서비스의 개인정보 유출 및 보안 문제로 인해 사용자들은 익명성과 보안성을 중시하는 경향이 있습니다. VeilGram은 이러한 요구를 충족시키기 위해 설계되었습니다. 사용자 정보를 최소화 하여 익명 프로필을 생성하고 SNS의 기본 기능인 소통에 멀티미디어 업로드와 투표 기능 등 다양한 방식을 추가로 제공하여 사용자 경험을 최우선으로 고려합니다.

### 3. 범위

VeilGram은 다음과 같은 주요 기능을 포함합니다:

1. 익명 회원가입 및 로그인
2. 익명 프로필 생성 및 관리
3. 멀티미디어 게시물 작성 및 상호작용
4. 실시간 피드 및 탐색 기능
5. 사용자 간의 팔로우 및 언팔로우 기능
6. 알림 시스템
7. 검색 기능(사용자, 게시물, 해시태그)

또한, 다음과 같은 비기능 요구사항을 충족합니다:

1. 성능: API 응답 시간 P99 < 300ms
2. 확장성: 부하에 따라 수직적 및 수평적 확장
3. 가용성: SLA 99.9% 이상
4. 보안: TLS 암호화, Rate Limiting, 인증/인가
5. 프라이버시: 로그 익명화, 데이터 보존 정책
6. 운영 모니터링: 로그 분석, 지표 수집 및 알림
7. CI/CD: 자동 테스트 및 GitOps 배포

## 2. 기능 요구사항

### 1. 사용자 관리

| ID     | 요구사항        | 설명                                                      | 우선순위 |
| ------ | -------------- | --------------------------------------------------------- | ------- |
| USE-1  | 회원가입        | PII 없이 익명 키로 가입                                    | 필수     |
| USE-2  | 로그인          | 키로 로그인                                                | 필수    |
| USE-3  | 동시 로그인 제한 | 동일 키로 1개 디바이스만 로그인 허용                        | 필수     |
| USE-4  | 회원 탈퇴       | 익명 키로 회원 탈퇴 시 모든 데이터 삭제                      | 필수    |
| USE-5  | 비활성 계정 관리 | 사용자가 지정한 기간(예: 1년) 동안 활동이 없을 경우 계정 삭제 | 중요    |
| USE-6  | 프로필 관리     | 프로필 생성, 닉네임 설정 및 변경, 중복 검사 및 차단어 필터링  | 필수     |
| USE-7  | 프로필 조회     | 프로필 정보 조회, 팔로워/팔로잉 수 포함                      | 필수    |
| USE-8  | 팔로우/언팔로우 | 팔로우/언팔로우, 중복 방지 및 알림 설정                      | 필수     |
| USE-9  | 사용자 차단     | 차단된 사용자로부터의 게시물 및 댓글 숨김                    | 중요     |
| USE-10 | 사용자 통계     | 사용자 활동 통계 제공 (게시물 수, 팔로워 수 등)              | 보통     |
| USE-11 | 사용자 활동 로그 | 로그인, 게시물 작성 등 주요 활동 로그 기록                  | 보통     |
| USE-12 | 사용자 신고     | 사용자 신고 및 차단, 신고 사유 선택 및 관리                  | 중요     |
| USE-13 | 사용자 알림 설정 | 팔로우, 게시물, 댓글, 좋아요 알림 설정                      | 중요     |
| USE-14 | 사용자 검색     | 사용자 이름, 닉네임, 키워드 기반 검색                       | 필수     |
| USE-15 | 사용자 필터링   | NSFW, 욕설 및 스팸 키워드 필터링                            | 필수     |

### 2. 게시물 관리

| ID     | 요구사항        | 설명                                              | 우선순위 |
| ------ | -------------- | ------------------------------------------------- | ------- |
| POS-1  | 게시물 작성     | 텍스트, 이미지(JPEG/PNG), 동영상(MP4), 투표 포함    | 필수     |
| POS-2  | 게시물 조회     | 최신순, 인기순, 팔로우 피드 등 다양한 정렬 옵션 제공 | 필수     |
| POS-3  | 게시물 수정     | 작성자만 게시물 수정, 이미지 및 동영상 변경 지원     | 필수     |
| POS-4  | 게시물 삭제     | 작성자만 게시물 삭제, 댓글 및 좋아요도 함께 삭제     | 필수     |
| POS-5  | 게시물 좋아요   | 게시물에 좋아요, 중복 방지                          | 필수     |
| POS-6  | 게시물 공유     | 게시물 재게시(리그램) 및 출처 표시                  | 보통     |
| POS-7  | 게시물 해시태그 | 자동 해시태그 인식                                 | 중요     |
| POS-8  | 게시물 북마크   | 게시물 북마크, 북마크한 게시물 조회                  | 보통     |
| POS-9  | 게시물 통계     | 게시물 조회수, 좋아요 수, 댓글 수 통계 제공          | 보통     |
| POS-10 | 게시물 신고     | 게시물 신고 및 작성자 차단, 신고 사유 선택 및 관리   | 중요     |
| POS-11 | 게시물 필터링   | NSFW, 욕설 및 스팸 키워드 필터링                    | 필수     |
| POS-12 | 게시물 알림     | 게시물 작성 시 팔로워에게 알림 전송                 | 중요     |
| POS-13 | 게시물 검색     | 게시물 내용, 해시태그 기반 검색 기능 제공            | 필수     |

### 3. 댓글 관리

| ID    | 요구사항    | 설명                                             | 우선순위 |
| ----- | ---------- | ------------------------------------------------ | ------- |
| COM-1 | 댓글 작성   | 댓글 작성, 이미지 및 동영상 첨부 가능              | 필수     |
| COM-2 | 댓글 조회   | 게시물별 댓글 조회, 최신순 및 인기순 정렬 옵션 제공 | 필수     |
| COM-3 | 댓글 수정   | 작성자만 댓글 수정, 이미지 및 동영상 변경 지원      | 필수     |
| COM-4 | 댓글 삭제   | 작성자만 댓글 삭제, 대댓글 및 좋아요도 함께 삭제    | 필수     |
| COM-5 | 대댓글      | 댓글에 대한 대댓글 작성 및 조회                   | 중요     |
| COM-6 | 댓글 좋아요 | 댓글에 좋아요, 중복 방지                          | 중요     |
| COM-7 | 댓글 신고   | 댓글 신고 및 작성자 차단, 신고 사유 선택 및 관리    | 중요     |
| COM-8 | 댓글 필터링 | NSFW, 욕설 및 스팸 키워드 필터링                   | 필수     |
| COM-9 | 댓글 알림   | 댓글 작성 시 게시물 작성자 및 팔로워에게 알림 전송  | 중요     |

### 4. 피드 및 탐색

| ID     | 요구사항             | 설명                                  | 우선순위 |
| ------ | ------------------- | ------------------------------------- | ------- |
| FED-1  | 팔로우 기반 피드     | 팔로우 중인 사용자의 최신 게시물 제공    | 필수    |
| FED-2  | 인기 게시물 피드     | 전체 사용자 중 인기 게시물 제공          | 중요    |
| FED-3  | 해시태그 피드        | 특정 해시태그를 포함한 게시물 제공       | 중요    |
| FED-4  | 탐색(Discover)      | 인기 콘텐츠, 추천 해시태그·사용자 노출   | 중요    |
| FED-5  | 실시간 피드 업데이트 | WebSocket/SSE 기반 실시간 피드 반영     | 중요    |
| FED-6  | 사용자 추천         | 사용자 활동 기반 추천                    | 중요    |
| FED-7  | 인기 해시태그       | 현재 인기 있는 해시태그 목록 제공         | 중요    |
| FED-8  | 피드 필터링         | NSFW, 욕설 및 스팸 키워드 필터링         | 필수    |
| FED-9  | 피드 검색           | 게시물 내용, 해시태그 기반 검색 기능 제공 | 필수    |
| FED-10 | 피드 알림           | 신규 피드 업데이트 시 알림 전송          | 중요    |

## 3. 비기능 요구사항

### 1. 성능

| ID     | 분류               | 요구사항             | 설명                       |
| ------ | ----------------- | -------------------- | -------------------------- |
| PEF-1  | 응답 시간          | P99 < 300ms          | API 레이턴시 최적화         |
| PEF-2  | 데이터 처리량       | 초당 16,000 요청     | 대규모 트래픽 처리 가능     |
| PEF-3  | 캐싱               | Redis 사용           | 정적 자산 및 미디어 캐싱    |
| PEF-4  | 데이터베이스 최적화 | 인덱싱 및 쿼리 최적화 | 대용량 데이터 조회 성능 향상 |

### 2. 확장성

| ID    | 분류            | 요구사항                  | 설명                             |
| ----- | --------------- | ------------------------ | ------------------------------- |
| SCA-1 | 오토스케일링     | 수평적 확장               | Kubernetes 기반 오토스케일링 지원 |
| SCA-2 | DB 샤딩/파티셔닝 | 데이터베이스 샤딩/파티셔닝 | 대용량 데이터 처리 성능 향상       |
| SCA-3 | API 게이트웨이   | API Gateway 사용         | 서비스 간 통신 및 인증 관리       |

### 3. 가용성

| ID     | 분류       | 요구사항             | 설명                                      |
| ------ | -----------| -------------------- | ---------------------------------------- |
| AVA-1  | SLA        | SLA 99.9%            | 서비스 가용성 보장                        |
| AVA-2  | 무중단 배포 | 오류 시 자동 복구/롤백 | k8s 롤링 업데이트 및 Canary 배포 지원     |
| AVA-3  | 장애 조치   | 자동 장애 조치        | 장애 발생 시 자동으로 대체 인스턴스로 전환 |
| AVA-4  | 로드 밸런싱 | 로드 밸런싱 사용       | 트래픽 분산을 통한 가용성 향상            |

### 4. 보안

| ID    | 분류           | 요구사항                        | 설명                                  |
| ----- | ------------- | ------------------------------- | ------------------------------------- |
| SEC-1 | 암호화         | 전송(TLS) 및 저장(디스크) 암호화  | 모든 데이터 전송 및 저장 시 암호화 적용 |
| SEC-2 | Rate Limiting | API 호출 제한 및 DDoS 대응        | IP 기반 Rate Limiting 적용            |
| SEC-3 | 인증·인가      | 올바른 권한을 가진 사용자인지 확인 | 사용자 인증 및 권한 관리               |
| SEC-4 | IP 블랙리스트  | 악성 IP 차단                     | 악성 트래픽 발생 IP 차단               |

### 5. 프라이버시·컴플라이언스

| ID    | 분류            | 요구사항                     | 설명                                 |
| ----- | -------------- | ---------------------------- | ----------------------------------- |
| PRI-1 | 로그 익명화     | IP·기기 정보 해싱             | 사용자 로그에서 PII 제거              |
| PRI-2 | 데이터 보존 정책 | 게시물·로그 90일 후 자동 삭제 | 사용자 데이터 최소화 및 보존 기간 설정 |

### 6. 운영 모니터링·로깅

| ID    | 분류                | 요구사항                               | 설명                              |
| ----- | ------------------ | -------------------------------------- | --------------------------------- |
| MON-1 | 로그 분석           | ELK/EFK 스택 활용                       | 로그 수집 및 분석                  |
| MON-2 | 지표 수집·알림      | Prometheus/Grafana 기반 모니터링 및 알림 | 시스템 성능 및 상태 모니터링        |
| MON-3 | 경고 시스템         | 이상 징후 감지 및 알림                   | 시스템 이상 징후 감지 및 알림 설정  |
| MON-4 | 대시 로그 관리      | 중앙 집중식 로그 관리 시스템 사용         | 로그 수집 및 검색 최적화           |
| MON-5 | 시스템 상태 모니터링 | 실시간 시스템 상태 모니터링              | CPU, 메모리, 디스크 사용량 모니터링 |

### 7. CI/CD

| ID   | 분류        | 요구사항                            | 설명                            |
| ---- | ----------- | ---------------------------------- | ------------------------------- |
| CI-1 | 자동 테스트  | pytest, lint, 보안 스캔 자동 실행   | 코드 품질 및 보안 검사 자동화      |
| CI-2 | GitOps 배포 | Git 머지 시 자동 배포 트리거         | 코드 변경 시 자동 배포            |
| CI-3 | 빌드·배포   | Docker 이미지 빌드 및 배포           | 컨테이너 기반 배포 환경 구축      |
| CI-4 | 테스트 환경 | 테스트 환경 자동화 구축              | 개발 및 테스트 환경 분리 및 자동화 |
| CI-5 | 코드 리뷰   | Pull Request 기반 코드 리뷰 프로세스 | 코드 품질 향상 및 협업 강화       |
